---
export const prerender = true;

import Hero from "@/components/Hero.astro";
import Section from "@/components/Section.astro";
import Layout from "@/layouts/Layout.astro";
import { getHeaderLinks } from "@/lib/get-header-links";
import { getWrappedSdk } from "@/lib/get-wrapped-sdk";
import { Image } from "astro:assets";
import magicalCosplayConLogo from "@/images/magical_cosplay_con_logo.svg";
import EventInfo from "@/components/EventInfo.astro";
import { getTypedTableData } from "@/lib/get-typed-table-data";

const sdk = getWrappedSdk();
const { data } = await sdk.Layout();
const {
  data: { cosplayCon },
} = await sdk.CosplayCon();

Astro.response.headers.set("Cache-Control", "public, max-age=1800, s-maxage=1800");
---

<Layout
  title={cosplayCon!.seo!.metaTitle}
  description={cosplayCon!.seo!.metaDescription}
  headerLinks={getHeaderLinks(data)}
  class="bg-fuchsia-200"
>
  <Hero
    bgColorClass="bg-fuchsia-950"
    gradientClass="from-violet-200 to-pink-200"
    text={cosplayCon!.seo!.metaDescription}
    class="text-white"
  >
    <Image
      slot="logo"
      src={magicalCosplayConLogo}
      height="300"
      width="480"
      alt="Magical Cosplay Con logo"
      widths={[240, 540, 720, magicalCosplayConLogo.width]}
    />
  </Hero>
  <EventInfo
    target="25 July 2026 10:00:00"
    day="25 + 26 July 2026"
    time="10:00 - 18:00"
    location="Belgium - GC Klein Boom, Mechelbaan 604, 2580 Putte"
  >
    <a
      slot="cta-button"
      href="https://magical-cosplay-con.eventsquare.store/lign7srh9jyr"
      target="_blank"
      class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded self-start mt-2"
    >
      Buy ticket
    </a>
  </EventInfo>
  {
    cosplayCon?.sections?.map((section, i) => (
      <Section
        headingGradientClass="from-[#232946] to-indigo-600"
        title={section!.title}
        subText={section!.subText!}
        {...(i % 2 !== 0 && { class: "bg-white" })}
      >
        {section!.Images.length ? (
          <div slot="content" class="container max-w-5xl mx-auto flex justify-center flex-col items-center mt-6">
            <div class="flex gap-10 flex-col md:flex-row">
              {section!.Images.map((image) => (
                <div>
                  <Image
                    src={image!.url}
                    alt={image?.alternativeText ?? image!.name}
                    quality={90}
                    width={image!.width!}
                    height={image!.height!}
                    class="rounded-lg max-w-96"
                  />
                  <p class="text-lg mt-4">{image!.caption}</p>
                </div>
              ))}
            </div>
          </div>
        ) : null}
        {section?.table ? (
          <div slot="content" class="container max-w-5xl mx-auto flex justify-center flex-col items-center mt-6">
            <table class="md:table-auto table-fixed text-center md:text-left w-full">
              <thead>
                <tr>
                  {getTypedTableData(section.table).columns.map((column) => (
                    <th class="md:px-6">{column.label}</th>
                  ))}
                </tr>
              </thead>
              <tbody>
                {getTypedTableData(section.table).rows.map((row) => (
                  <tr>
                    {row.map((content) => (
                      <td class="md:px-6">{content}</td>
                    ))}
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        ) : null}
      </Section>
    ))
  }
</Layout>
